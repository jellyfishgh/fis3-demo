define("static/lucky/src/lucky",["sea-modules/jquery/jquery/1.10.1/jquery","sea-modules/jquery/easing/1.3.0/easing","static/lucky/src/user"],function(t,e,i){function s(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function r(t,e){return s(t,e)<=(t.width+e.width)/2}function n(t,e){var i=e.y-t.y,r=e.x-t.x,n=s(t,e),u=Math.ceil(((t.width+e.width)/2-n)/c),a=i>0?Math.ceil(u*i/n):Math.floor(u*i/n),o=r>0?Math.ceil(u*r/n):Math.floor(u*r/n);t.lucky?(e._xMove+=2*o,e._yMove+=2*a):e.lucky?(t._xMove+=-2*o,t._yMove+=-2*a):(t._yMove+=-1*a,e._yMove+=a,t._xMove+=-1*o,e._xMove+=o)}var u=t("sea-modules/jquery/jquery/1.10.1/jquery");t("sea-modules/jquery/easing/1.3.0/easing");var a=t("static/lucky/src/user"),o=100,c=4;i.exports={users:[],init:function(t){u("#container").css("background","none"),this.data=t,this.users=t.map(function(e){return new a(e,t[e])}),this._bindUI()},_bindUI:function(){function t(){"start"===i.getAttribute("data-action")?(i.setAttribute("data-action","stop"),i.innerHTML=i.getAttribute("data-text-stop"),e.start()):(i.setAttribute("data-action","start"),i.innerHTML=i.getAttribute("data-text-start"),e.stop())}var e=this,i=document.querySelector("#go");i.innerHTML=i.getAttribute("data-text-start"),i.addEventListener("click",t,!1),u("#lucky-balls").on("click","li",function(t){var s=u(t.target),r=s.text();e.addItem(r),"start"===i.getAttribute("data-action")&&e.hit(),s.remove()}),u("#balls").on("click","li",function(t){for(var s=u(t.target),r=s.text(),n=0;n<e.users.length;n++){var a=e.users[n];if(a.name===r){e.moveLucky()||e.luckyUser===a||(i.setAttribute("data-action","start"),i.innerHTML=i.getAttribute("data-text-start"),e.setLucky(a));break}}}),document.addEventListener("keydown",function(i){"32"==i.keyCode?t():"27"==i.keyCode&&(e.moveLucky(),u("#lucky-balls li").eq(0).click())},!1)},start:function(){this.timer&&clearTimeout(this.timer),this.moveLucky(),this.users.forEach(function(t){t.start()})},stop:function(){var t=this.users,e=0,i=t[0];t.forEach(function(t){t.stop(),e<t.zIndex&&(i=t,e=t.zIndex)}),i.bang(),this.hit(),this.luckyUser=i},removeItem:function(t){for(var e=0;e<this.users.length;e++){var i=this.users[e];i===t&&this.users.splice(e,1)}},addItem:function(t){this.users.push(new a(t))},moveLucky:function(){var t=this.luckyUser;return t?(t.el[0].style.cssText="",t.el.prependTo("#lucky-balls"),this.removeItem(t),this.luckyUser=null,!0):!1},setLucky:function(t){this.users.forEach(function(t){t.stop()}),this.luckyUser=t,t.bang(),this.hit()},hit:function(){var t=this,e=0,i=this.users;i.forEach(function(t){t.beginHit()});for(var s=0;s<i.length;s++)for(var u=s+1;u<i.length;u++)r(i[s],i[u])&&(n(i[s],i[u]),e++);i.forEach(function(t){t.hitMove()}),e>0&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.hit()},o))}}});