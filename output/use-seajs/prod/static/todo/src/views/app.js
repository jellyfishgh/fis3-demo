define("static/todo/src/views/app",["sea-modules/jquery/jquery/1.10.1/jquery","sea-modules/gallery/underscore/1.4.4/underscore","sea-modules/gallery/backbone/1.0.0/backbone","static/todo/src/views/todos","static/todo/src/collections/todos","static/todo/src/common"],function(e,t,i){var o,s,l,n,r,a=e("sea-modules/jquery/jquery/1.10.1/jquery"),c=e("sea-modules/gallery/underscore/1.4.4/underscore");o=e("sea-modules/gallery/backbone/1.0.0/backbone"),s=e("static/todo/src/views/todos"),l=e("static/todo/src/collections/todos"),n=e("static/todo/src/common"),r=o.View.extend({el:"#todoapp",statsTemplate:c.template(a("#stats-template").html()),events:{"keypress #new-todo":"createOnEnter","click #clear-completed":"clearCompleted","click #toggle-all":"toggleAllComplete"},initialize:function(){this.allCheckbox=this.$("#toggle-all")[0],this.$input=this.$("#new-todo"),this.$footer=this.$("#footer"),this.$main=this.$("#main"),this.listenTo(l,"add",this.addOne),this.listenTo(l,"reset",this.addAll),this.listenTo(l,"change:completed",this.filterOne),this.listenTo(l,"filter",this.filterAll),this.listenTo(l,"all",this.render),l.fetch()},render:function(){var e=l.completed().length,t=l.remaining().length;l.length?(this.$main.show(),this.$footer.show(),this.$footer.html(this.statsTemplate({completed:e,remaining:t})),this.$("#filters li a").removeClass("selected").filter('[href="#/'+(n.TodoFilter||"")+'"]').addClass("selected")):(this.$main.hide(),this.$footer.hide()),this.allCheckbox.checked=!t},addOne:function(e){var t=new s({model:e});a("#todo-list").append(t.render().el)},addAll:function(){this.$("#todo-list").html(""),l.each(this.addOne,this)},filterOne:function(e){e.trigger("visible")},filterAll:function(){l.each(this.filterOne,this)},newAttributes:function(){return{title:this.$input.val().trim(),order:l.nextOrder(),completed:!1}},createOnEnter:function(e){e.which===n.ENTER_KEY&&this.$input.val().trim()&&(l.create(this.newAttributes()),this.$input.val(""))},clearCompleted:function(){return c.invoke(l.completed(),"destroy"),!1},toggleAllComplete:function(){var e=this.allCheckbox.checked;l.each(function(t){t.save({completed:e})})}}),i.exports=r});